[[extend 'layout.html']]

<style>
  [v-cloak] {
    display: none;
  }
</style>


<div class="section" id="vue-target" v-cloak>

  <div class="columns">
    <div class="column is-8 is-offset-2">
      <div class="columns">
        <div class="column is-7">
          <div>
            <div class="pantryBox" @click="pantryExpanded=true">
              <div class="columns m-0">
                <div class="column is-6 p-0">
                  <div class="titleText">My pantry</div>
                </div>
                <div class="column is-6 p-0">
                  <div class="mt-3">
                    <div class="pantryTextBoxContainer">
                      <div class="control has-icons-right"></p>
                        <input class="pantryTextBox" type="text" placeholder="Add item" maxlength="28" v-model="ingredientInput" v-on:keyup.enter="addItemToPantry">
                        <span v-show="ingredientInput.length != 0" class="icon is-right is-clickable" @click="clearIngredientInput">
                          <i class="fa fa-times-circle"></i>
                        </span>
                      </div>
                    </div>
                    <div class="is-clickable addButton" @click="addItemToPantry">
                      <i class="fa fa-plus"></i>
                    </div>
                  </div>
                </div>
              </div>
              <div class="pantryBody">
                <div v-if="pantry.length == 0" class="emptyPantry">Add some items...</div>
                <div v-if="pantryExpanded == false" v-for="n in 5" class="itemRow">
                  <div class="columns">
                    <div class="column is-6 mt-3 mb-3 p-0">
                      <div v-if="pantry.length > (n+n-2)" class="pantryItem ml-3" @mouseenter="displayTrash = n+n-1" @mouseleave="displayTrash = -1">
                        <span class="level top-8">
                          <span class="level-left ml-1">{{pantry[(n+n-2)].item}}</span>
                          <span v-if="displayTrash == n+n-1" class="icon level-right is-small is-clickable mr-2 icon-color">
                            <i class="fa fa-trash" @click="deleteItem(pantry[(n+n-2)].id)"></i>
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="column is-6 mt-3 mb-3 p-0">
                      <div v-if="pantry.length > (n+n-1)" class="pantryItem mr-3" @mouseenter="displayTrash = n+n" @mouseleave="displayTrash = -1">
                        <span class="level top-8">
                          <span class="level-left ml-1">{{pantry[(n+n-1)].item}}</span>
                          <span v-if="displayTrash == n+n" class="icon level-right is-small is-clickable mr-2 icon-color">
                            <i class="fa fa-trash" @click="deleteItem(pantry[(n+n-1)].id)"></i>
                          </span>
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
                <div v-if="pantryExpanded == true" v-for="n in numPantryRows" class="itemRow">
                  <div class="columns">
                    <div class="column is-6 mt-3 mb-3 p-0">
                      <div v-if="pantry.length > (n+n-2)" class="pantryItem ml-3" @mouseenter="displayTrash = n+n-1" @mouseleave="displayTrash = -1">
                        <span class="level top-8">
                          <span class="level-left ml-1">{{pantry[(n+n-2)].item}}</span>
                          <span v-if="displayTrash == n+n-1" class="icon level-right is-small is-clickable mr-2 icon-color">
                            <i class="fa fa-trash" @click="deleteItem(pantry[(n+n-2)].id)"></i>
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="column is-6 mt-3 mb-3 p-0">
                      <div v-if="pantry.length > (n+n-1)" class="pantryItem mr-3" @mouseenter="displayTrash = n+n" @mouseleave="displayTrash = -1">
                        <span class="level top-8">
                          <span class="level-left ml-1">{{pantry[(n+n-1)].item}}</span>
                          <span v-if="displayTrash == n+n" class="icon level-right is-small is-clickable mr-2 icon-color">
                            <i class="fa fa-trash" @click="deleteItem(pantry[(n+n-1)].id)"></i>
                          </span>
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div v-if="numPantryRows > 5" class="pb-3"></div>
            </div>
            <div v-if="numPantryRows > 5">
              <div v-if="!pantryExpanded" class="minimizeButton is-clickable" @click="pantryExpanded=true">
                <i class="fa fa-caret-down mt-1"></i>
              </div>
              <div v-else class="minimizeButton is-clickable" @click="pantryExpanded=false">
                <i class="fa fa-caret-up"></i>
              </div>
            </div>
          </div>
        </div>
        <div class="column is-5">
          <!-- Main columns div -->
          <div class="block">
            <button class="button is-link" @click="addRecipe">Generate New Recipe!</button>
          </div>

          <article v-for="recipe in recipes" class="message is-dark control">
            <div class="message-header">
              <p>Recipe # {{recipe._idx}}</p>
              <button class="button is-link is-rounded is-small is-responsive" @click="toggleRecipe(recipe._idx)">show/hide</button>
              <!-- <button class="delete" aria-label="delete"></button> -->
            </div>
            <!-- TODO: Add loading sign to "Regen Recipe" while recipe is currently being generated -->
            <div v-if="recipe.show" class="message-body"> 
              <button class="button is-link" @click="genRecipe(recipe._idx)">Regenerate Recipe!</button>
              <div class="content" style="white-space: pre-line;">
                {{recipe.content}}
              </div>
            </div>
          </article>
        </div>
      </div>
    </div>
  </div>  

  <!-- <button class="button is-warning" @click="generateRecipeSuggestion">Test AI Completion python function</button> -->

  <!-- section end div -->
</div>


[[block page_scripts]]
<!-- Loads the index-specific js for Vue -->
<script>
  let getPantry_url = "[[=XML(getPantry_url)]]";
  let addItemToPantry_url = "[[=XML(addItemToPantry_url)]]";
  let deleteItem_url = "[[=XML(deleteItem_url)]]";
  let generateRecipeSuggestion_url = "[[=XML(generateRecipeSuggestion_url)]]";
  let getRecipes_url = "[[=XML(getRecipes_url)]]";

</script>
<script src="js/index.js"></script>
[[end]]
